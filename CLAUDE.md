# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## プロジェクト概要

上海麻雀学園 (Shanghai Mahjong Academy) - ゲーム開発プロジェクト
現在は初期段階で、主にプロジェクト設定とAI協業フレームワークの構築段階

## Gemini CLI 連携

### トリガー
ユーザーが「Geminiと相談しながら進めて」（または類似表現）とリクエストした場合、Claude はセッション全体を通じて Gemini CLI と協業します。

### 協業時の Claude の役割
- **批判的評価者**: Gemini の提案を鵜呑みにせず、必ず検証・評価する
- **統合責任者**: 複数の視点を統合し、最終判断を行う
- **品質管理者**: 実装の実現可能性、保守性、パフォーマンスを評価

### 協業ワークフロー
1. **PROMPT 準備**: 最新の要件と議論要約を `$PROMPT` に格納
2. **Gemini 呼び出し** (バックグラウンド実行で自動進行):
   ```bash
   gemini <<EOF
   $PROMPT
   
   重要：以下の観点で複数の選択肢を提示してください：
   - 長所と短所を明確に
   - トレードオフを具体的に
   - 実装難易度の評価
   EOF
   ```
   ※ Claude は `run_in_background: true` でGeminiを呼び出し、結果を自動的に取得・評価します
3. **出力形式**:
   ```md
   **Gemini ➜**
   <Gemini からの応答>

   **Claude ➜**
   <評価フレームワークに基づく分析>
   ```

### 📊 Claude の評価フレームワーク
**Claude ➜** セクションは必ず以下の構造に従う：

```
## Gemini提案の評価
✅ **採用可能な要素**: [具体的な良い点]
⚠️ **技術的懸念**: [実装上の問題点やリスク]
🔄 **Claude の代替案**: [独自の第3の選択肢]

## 最終判断
- **採用方針**: [Gemini案/Claude案/折衷案]
- **根拠**: [なぜその判断に至ったか]
- **実装計画**: [具体的な次のステップ]
```

### ⚡ 鵜呑み防止ルール
1. **Gemini の提案をそのまま採用することは禁止**
2. **必ず技術的検証を行う**
3. **独自案の検討を義務化**

## プロジェクト構成

このプロジェクトは現在初期段階で、以下のファイルのみ存在：
- `CLAUDE.md`: Claude Code用ガイドライン
- `GEMINI.md`: Gemini CLI連携用ガイドライン

## 開発ガイドライン

### AI協業プロセス
- Geminiとの協業時は必ずGEMINI.mdで定義されたフォーマットに従う
- 複数の選択肢を評価し、技術的トレードオフを考慮する
- 実装前に必ずユーザーに確認を求める

## 重要な注意事項

- ユーザーが明示的に要求しない限りファイルを作成しない
- 新規ファイル作成より既存ファイルの編集を常に優先する
- コードベース内の既存のコードパターンと規約に従う
- 特に指定がない限り、すべてのコード変更は後方互換性を維持する

## プロジェクト固有の指示

### 言語とローカライゼーション
- プロジェクト名は日本語（上海麻雀学園）
- コードコメントやドキュメントは日本語と英語を適切に使い分ける
- ゲーム用語は麻雀の専門用語に準拠

### ゲーム開発の考慮事項
- 麻雀ルールの正確な実装を重視
- ユーザーエクスペリエンスを最優先
- パフォーマンスとメモリ効率の最適化